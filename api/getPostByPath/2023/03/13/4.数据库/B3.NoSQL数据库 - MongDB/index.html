{"type":"getPostByPath","data":{"title":"NoSQL篇-MongDB数据库","date":"2023-03-13T12:32:38.445Z","description":"","categories":[{"name":"数据库","_id":"clffhi6vj001v2sq4g1uc41n2"}],"tags":[{"name":"MongDB NoSQL 数据库","_id":"clffhi6vk001w2sq41zpl69dv"}],"content":"<h2 id=\"1-MongDB的简介：\"><a href=\"#1-MongDB的简介：\" class=\"headerlink\" title=\"1.MongDB的简介：\"></a>1.MongDB的简介：</h2><ul>\n<li>MongoDB是一个开源、高性能、无模式的<strong>文档型数据库</strong></li>\n<li>当初的设计就是用于简化开发和方便扩展，是<strong>NoSQL</strong>数据库产品中的一种。是<strong>最像关系型数据库（MySQL）的非关系型数据库</strong>。</li>\n<li>它支持的数据结构非常松散，是一种类似于 JSON 的 格式叫BSON，所以它既可以存储比较复杂的数据类型，又相当的灵活。</li>\n<li>MongoDB中的<strong>记录是一个文档</strong>，它是一个由<strong>字段和值对</strong>（fifield:value）组成的数据结构。MongoDB文档类似于JSON对象，即一个文档认为就是一个对象。字段的数据类型是字符型，它的值除了使用基本的一些类型外，还可以包括其他文档、普通数组和文档数组。</li>\n</ul>\n<h2 id=\"2-MongDB的相关概念：\"><a href=\"#2-MongDB的相关概念：\" class=\"headerlink\" title=\"2.MongDB的相关概念：\"></a>2.MongDB的相关概念：</h2><ul>\n<li>MongoDB可应对三高需求：<ul>\n<li>High performance - 对数据库高并发读写的需求</li>\n<li>Huge Storage - 对海量数据的高效率存储和访问的需求</li>\n<li>High Scalability &amp;&amp; High Availability- 对数据库的高可扩展性和高可用性的需求</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-MongDB的体系结构：\"><a href=\"#3-MongDB的体系结构：\" class=\"headerlink\" title=\"3.MongDB的体系结构：\"></a>3.MongDB的体系结构：</h2><ul>\n<li><p>mysql与MongDB对比</p>\n<p><img src=\"C:\\Users\\Administrator\\AppData\\Roaming\\Typora\\typora-user-images\\image-20230223212212941.png\" alt=\"image-20230223212212941\"></p>\n</li>\n</ul>\n<h2 id=\"4-MongDB的数据模型：\"><a href=\"#4-MongDB的数据模型：\" class=\"headerlink\" title=\"4.MongDB的数据模型：\"></a>4.MongDB的数据模型：</h2><ul>\n<li><p>MongoDB的<strong>最小存储单位</strong>就是<strong>文档(document)对象</strong>。文档(document)对象对应于关系型数据库的行。数据在MongoDB中以</p>\n<p>BSON（Binary-JSON）文档的格式存储在磁盘上。</p>\n</li>\n<li><p><strong>BSON</strong>（Binary Serialized Document Format）是一种<strong>类json的一种二进制形式的存储格式</strong>，简称Binary JSON。BSON和JSON一样，支持内嵌的文档对象和数组对象，但是BSON有JSON没有的一些数据类型，如Date和BinData类型。</p>\n</li>\n<li><p>BSON采用了类似于 C 语言结构体的名称、对表示方法，支持内嵌的文档对象和数组对象，具有<strong>轻量性、可遍历性、高效性</strong>的三个特点，可以有效描述非结构化数据和结构化数据。这种格式的优点是灵活性高，但它的缺点是空间利用率不是很理想。</p>\n</li>\n</ul>\n<h2 id=\"5-MongDB的特点：\"><a href=\"#5-MongDB的特点：\" class=\"headerlink\" title=\"5.MongDB的特点：\"></a>5.MongDB的特点：</h2><ul>\n<li>高性能：</li>\n<li>高可用性：</li>\n<li>高扩展性：</li>\n<li>丰富的查询支持：</li>\n</ul>\n<h2 id=\"6-安装与配置：\"><a href=\"#6-安装与配置：\" class=\"headerlink\" title=\"6.安装与配置：\"></a>6.安装与配置：</h2><h3 id=\"1-yum安装：\"><a href=\"#1-yum安装：\" class=\"headerlink\" title=\"1.yum安装：\"></a>1.yum安装：</h3><ul>\n<li><p>配置yum仓库：</p>\n<img src=\"C:\\Users\\Administrator\\AppData\\Roaming\\Typora\\typora-user-images\\image-20230223204743691.png\" alt=\"image-20230223204743691\" style=\"zoom: 80%;\" />\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mongodb]</span><br><span class=\"line\">name=mongo</span><br><span class=\"line\">baseurl=https://mirrors.aliyun.com/mongodb/yum/redhat/8Server/mongodb-org/4.4/x86_64/</span><br><span class=\"line\">gpgcheck=0</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>安装：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y mongodb-org</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>配置资源限制：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">配置资源限制</span></span><br><span class=\"line\">[root@kittod ~]# vim /etc/security/limits.conf</span><br><span class=\"line\">* soft nofile 65536</span><br><span class=\"line\">* hard nofile 65536</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">默认情况下 MongoDB运行使用 mongod用户和下面的默认目录</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">这种安装方式将创建默认目录，并将这些目录的所有者和组设置为 mongod。</span></span><br><span class=\"line\">[root@quruixiang yum.repos.d]# ll /var/lib/mongo/</span><br><span class=\"line\">total 0</span><br><span class=\"line\">[root@quruixiang yum.repos.d]# ll /var/log/mongodb</span><br><span class=\"line\">total 0</span><br><span class=\"line\">-rw-r----- 1 mongod mongod 0 Sep 29 05:53 mongod.log</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>重启MongoDB：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart mongod</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>连接MongoDB</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongo --host=127.0.0.1 --port=27017</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"2-docker安装：\"><a href=\"#2-docker安装：\" class=\"headerlink\" title=\"2.docker安装：\"></a>2.docker安装：</h3><ul>\n<li><p>创建mongdb目录并打开它：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir ~/mongdb &amp; cd ~/mongodb</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>方式一：无账号密码，不需要认证的安装：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d --name mongodb --restart always --privileged -p 27017:27017 \\</span><br><span class=\"line\">-v $PWD/data:/data/db mongo:4.2.2</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">参数：</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">--privileged 拥有真正的root权限</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">--restart=always Docker服务重启容器也启动</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it mongodb /bin/bash</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongo</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>方式二：有账号密码，需要认证的安装：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d --name mongodb --restart always --privileged -p 27017:27017 -v $PWD/data:/data/db \\</span><br><span class=\"line\">-e MONGO_INITDB_ROOT_USERNAME=admin \\</span><br><span class=\"line\">-e MONGO_INITDB_ROOT_PASSWORD=123456 \\</span><br><span class=\"line\">mongo:4.2.2 mongod --auth</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">参数：</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-e MONGO_INITDB_ROOT_USERNAME=admin 指定用户名</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-e MONGO_INITDB_ROOT_PASSWORD=123456 指定密码</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">mongod --auth ：容器默认启动命令是mongod,我们认证需要修改启动命为mongod --auth开启认证</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it mongodb /bin/bash</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongo --host=127.0.0.1 --port 27017 -u admin -p 123456 --authenticationDatabase admin</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"7-数据库增删改查：\"><a href=\"#7-数据库增删改查：\" class=\"headerlink\" title=\"7.数据库增删改查：\"></a>7.数据库增删改查：</h2><ul>\n<li><p>描述：</p>\n<ul>\n<li>一个 mongodb 中可以建立多个数据库。 MongoDB 的默认数据库为”db”</li>\n<li>该数据库存储在 data 目录中</li>\n<li>MongoDB 的单个实例可以容纳多个独立的数据库，每一个都有自己的集合和权限， 不同的数据库也放置在不同的文件中</li>\n</ul>\n</li>\n<li><p>创建数据库和使用数据库：（新创建的数据库不会显示到数据库列表，除非数据库中有数据）</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use [数据库名]</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">命名规范：</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">不能是空字符串（<span class=\"string\">&quot;&quot;</span>)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">不得含有<span class=\"string\">&#x27; &#x27;</span>（空格)、.、$、/、\\和\\0 (空字符)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">应全部小写</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">最多 64 字节</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">admin： 从权限的角度来看，这是<span class=\"string\">&quot;root&quot;</span>数据库。要是将一个用户添加到这个 数据库，这个用户</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">        自动继承所有数据库的权限。一些特定的服务器端命令也只 能从这个数据库运行，比如列出所有</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">        的数据库或者关闭服务器</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"built_in\">local</span>: 这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集 合</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">config: 当 Mongo 用于分片设置时，config 数据库在内部使用，用于保存分片 的相关信息</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>查看所有数据库：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show dbs</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>查看当前正在使用的数据库：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>删除数据库：（先使用数据库）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.dropDatabase()</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"8-集合（表）增删改查：\"><a href=\"#8-集合（表）增删改查：\" class=\"headerlink\" title=\"8.集合（表）增删改查：\"></a>8.集合（表）增删改查：</h2><ul>\n<li><p>描述：</p>\n<ul>\n<li>文档是一组键值(key-value)对(即 BSON)</li>\n<li>MongoDB 的文档不需要设置相同的字段， 并且相同的字段不需要相同的数据类型，这与关系型数据库有很大的区别</li>\n</ul>\n</li>\n<li><p>创建集合：当向一个集合中插入一个文档的时候，如果集合不存在，则会自动创建集合</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.createCollection(name)</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.createCollection(&quot;mycollection&quot;)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>查询当前库中的j集合：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">show</span> collections</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>集合的删除：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.<span class=\"keyword\">drop</span>()</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.book.drop()</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"9-文档（行）增删改查：\"><a href=\"#9-文档（行）增删改查：\" class=\"headerlink\" title=\"9.文档（行）增删改查：\"></a>9.文档（行）增删改查：</h2><h3 id=\"1-新增数据：\"><a href=\"#1-新增数据：\" class=\"headerlink\" title=\"1.新增数据：\"></a>1.新增数据：</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合名称.<span class=\"keyword\">insert</span>(文档)</span><br><span class=\"line\">db.集合名称.insertOne(文档)      # 向集合插入一个新文档</span><br><span class=\"line\">db.集合名称.insertMany(文档)     # 向集合插入一个多个文档</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.book.insertOne(&#123;name:&quot;springboot&quot;,type:&quot;springboot&quot;&#125;)</span><br><span class=\"line\"># 参数：</span><br><span class=\"line\"># document：要写入的文档。</span><br><span class=\"line\"># writeConcern：写入策略，默认为 <span class=\"number\">1</span>，即要求确认写操作，<span class=\"number\">0</span> 是不要求。</span><br><span class=\"line\"># ordered：指定是否按顺序写入，默认 <span class=\"literal\">true</span>，按顺序写入。</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-修改数据：\"><a href=\"#2-修改数据：\" class=\"headerlink\" title=\"2.修改数据：\"></a>2.修改数据：</h3><ul>\n<li><p>修改满足条件的一条数据：（遇到数据修改后结束）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合名称.update(条件，&#123;操作种类:&#123;文档&#125;&#125;)</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.book.update(&#123;name:&quot;springboot&quot;&#125;,&#123;$set:&#123;name:&quot;springboot2&quot;&#125;&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>修改满足条件的一条数据：（让数值加一）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合名称.update(条件，&#123;操作种类:&#123;文档&#125;&#125;)</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.book.update(&#123;name:&quot;spring&quot;&#125;,&#123;$inc:&#123;count:NumberInt(1)&#125;&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>修改满足条件的多条数据：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合名称.<span class=\"keyword\">update</span>(条件，&#123;操作种类:&#123;文档&#125;&#125;,&#123;multi:<span class=\"literal\">true</span>&#125;)</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.book.update(&#123;name:&quot;springboot&quot;&#125;,&#123;$<span class=\"keyword\">set</span>:&#123;name:&quot;springboot2&quot;&#125;&#125;,&#123;multi:<span class=\"literal\">true</span>&#125;)</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"3-查看数据：\"><a href=\"#3-查看数据：\" class=\"headerlink\" title=\"3.查看数据：\"></a>3.查看数据：</h3><ul>\n<li><p>基础查询：</p>\n<ul>\n<li><p>查询全部：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.find(&#123;&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>查询第一条：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.findOne(&#123;文档&#125;)</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.book.findone(&#123;name:&quot;spring&quot;&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>查询指定数量文档：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.find(&#123;文档&#125;).limit(10)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>跳过指定数量文档：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.find(&#123;文档&#125;).skip(20)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>统计：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.count()</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>按条件排序：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合名称.find().sort(排序方式)</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.comment.find().sort(&#123;userid:-1,likenum:1&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>投影：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合名称.find(条件,&#123;文档&#125;)</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li><p>高级查询：</p>\n<ul>\n<li><p>模糊查询：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.find(&#123;域名:/正则表达式/&#125;)</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.comment.find(&#123;content:/开水/&#125;)  //包含“开水”的所有文档</span><br><span class=\"line\">db.comment.find(&#123;content:/^专家/&#125;)  //以“专家”开头的的文档</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>条件比较运算：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.find(&#123;字段:&#123;关键词:值&#125;&#125;)</span><br><span class=\"line\">关键词：</span><br><span class=\"line\">大于：$gt </span><br><span class=\"line\">小于： $lt</span><br><span class=\"line\">大于等于： $gte</span><br><span class=\"line\">小于等于： $lte</span><br><span class=\"line\">不等于：$ne</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.comment.find(&#123;likenum:&#123;$gt:NumberInt(700)&#125;&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>比较连接查询：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.find(连接词:[&#123;字段:&#123;关键词:值&#125;&#125;,&#123;...&#125;])</span><br><span class=\"line\">连接词：</span><br><span class=\"line\">和：$and</span><br><span class=\"line\">或：$or</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.comment.find(&#123;$and:[&#123;likenum:&#123;$gte:NumberInt(700)&#125;&#125;,&#123;likenum:&#123;$lt:NumberInt(2000)&#125;&#125;]&#125;)  //大于等于700 并且小于2000的文档</span><br><span class=\"line\">db.comment.find(&#123;$or:[ &#123;userid:&quot;1003&quot;&#125; ,&#123;likenum:&#123;$lt:1000&#125; &#125;]&#125;)  //userid为1003，或者点赞数小于1000的文档</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>包含查询：（等同于SQL中的in）</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合.find(&#123;域名:&#123;关键词:[值1，值2]&#125;&#125;)</span><br><span class=\"line\">关键词：</span><br><span class=\"line\">包含：$in</span><br><span class=\"line\">不包含：$nin</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.comment.find(&#123;userid:&#123;$in:[&quot;1003&quot;,&quot;1004&quot;]&#125;&#125;)   //字段包含1003或1004的文档</span><br><span class=\"line\">db.comment.find(&#123;userid:&#123;$nin:[&quot;1003&quot;,&quot;1004&quot;]&#125;&#125;)  //不包含1003和1004的文档</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"4-删除数据：\"><a href=\"#4-删除数据：\" class=\"headerlink\" title=\"4.删除数据：\"></a>4.删除数据：</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.集合名称.remove(条件)</span><br><span class=\"line\">例：</span><br><span class=\"line\">db.book.remove(&#123;type:&quot;springboot&quot;&#125;)</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"10-索引操作：\"><a href=\"#10-索引操作：\" class=\"headerlink\" title=\"10.索引操作：\"></a>10.索引操作：</h2><ul>\n<li><p>索引的查看：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.collection.getIndexes()</span><br><span class=\"line\">例：</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>索引的创建：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db.collection.createIndex(keys, options)</span><br><span class=\"line\">例：</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>索引的移除：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  </span><br></pre></td></tr></table></figure></li>\n</ul>\n","_path":"2023/03/13/4.数据库/B3.NoSQL数据库 - MongDB/","_link":"https://example.com/2023/03/13/4.%E6%95%B0%E6%8D%AE%E5%BA%93/B3.NoSQL%E6%95%B0%E6%8D%AE%E5%BA%93%20-%20MongDB/","_id":"clffhi6vh001s2sq4bans4ycz"}}